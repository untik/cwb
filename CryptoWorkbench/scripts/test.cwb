function testHash()
{
	// Test SHA1
	var v1 = Crypto.hex(Crypto.hash("The quick brown fox jumps over the lazy dog", 2));
	var v2 = "2fd4e1c67a2d28fced849ee1bb76e7391b93eb12";
	if (v1 != v2)
		return false;

	v1 = Crypto.hex(Crypto.hash("", 2));
	v2 = "da39a3ee5e6b4b0d3255bfef95601890afd80709"
	if (v1 != v2)
		return false;

	return true;
}

function testHex()
{
	var binary = Crypto.hash("The quick brown fox jumps over the lazy dog", 2);

	var v1 = Crypto.hex(binary);
	var v2 = Crypto.hex(Crypto.decodeHex(v1))
	if (v1 != v2)
		return false;

	v1 = Crypto.decodeHex(Crypto.hex(binary));
	if (v1 != binary)
		return false;
	v1 = Crypto.decodeHex(Crypto.hex(binary).toUpperCase());
	if (v1 != binary)
		return false;
	v1 = Crypto.decodeHex(Crypto.hex(binary, 1));
	if (v1 != binary)
		return false;

	return true;
}

function testBase64()
{
	var binary = Crypto.hash("The quick brown fox jumps over the lazy dog", 2);

	var v1 = Crypto.base64(binary);
	var v2 = Crypto.decodeBase64(v1)
	var v3 = Crypto.base64(v2)
	if (v1 != v3)
		return false;
	if (v2 != binary)
		return false;

	return true;
}

function test(name, func)
{
	if (func())
		output += name + " OK\n";
	else
		output += name + " Error\n";
}

function runTests()
{
	output = "";
	test("hash", testHash);
	test("hex", testHex);
	test("base64", testBase64);
}

runTests();

